<div class="row">
    <div class="col">
        {{adminltetags.useTag('fields',
            [
                'component'                             : component,
                'componentName'                         : componentName,
                'componentId'                           : componentId,
                'sectionId'                             : sectionId,
                'fieldId'                               : 'pwreset',
                'fieldLabel'                            : 'Password Reset',
                'fieldLabelLegend'                      : true,
                'fieldHidden'                           : false,
                'fieldType'                             : 'html',
                'fieldBazScan'                          : false,
                'fieldBazPostOnCreate'                  : false,
                'fieldBazPostOnUpdate'                  : false,
                'fieldBazJstreeSearch'                  : true,
                'fieldHtmlContent'                      : ''
            ]
        )}}
        <div class="row">
            <div class="col">
                {{adminltetags.useTag('fields',
                    [
                        'component'                             : component,
                        'componentName'                         : componentName,
                        'componentId'                           : componentId,
                        'sectionId'                             : sectionId,
                        'fieldId'                               : 'current_password',
                        'fieldLabel'                            : 'Current Password',
                        'fieldHidden'                           : false,
                        'fieldType'                             : 'input',
                        'fieldInputType'                        : 'password',
                        'fieldRequired'                         : true,
                        'fieldBazScan'                          : true,
                        'fieldBazPostOnCreate'                  : false,
                        'fieldBazPostOnUpdate'                  : false
                    ]
                )}}
            </div>
        </div>
        <div class="row">
            <div class="col">
                {{adminltetags.useTag('fields',
                    [
                        'component'                             : component,
                        'componentName'                         : componentName,
                        'componentId'                           : componentId,
                        'sectionId'                             : sectionId,
                        'fieldId'                               : 'new_password',
                        'fieldLabel'                            : 'New Password',
                        'fieldHidden'                           : false,
                        'fieldType'                             : 'input',
                        'fieldInputType'                        : 'password',
                        'fieldRequired'                         : true,
                        'fieldBazScan'                          : true,
                        'fieldBazPostOnCreate'                  : false,
                        'fieldBazPostOnUpdate'                  : false
                    ]
                )}}
            </div>
        </div>
        <div class="row">
            <div class="col">
                {{adminltetags.useTag('fields',
                    [
                        'component'                             : component,
                        'componentName'                         : componentName,
                        'componentId'                           : componentId,
                        'sectionId'                             : sectionId,
                        'fieldId'                               : 'confirm_password',
                        'fieldLabel'                            : 'Confirm Password',
                        'fieldHidden'                           : false,
                        'fieldType'                             : 'input',
                        'fieldInputType'                        : 'password',
                        'fieldBazScan'                          : true,
                        'fieldRequired'                         : true,
                        'fieldBazPostOnCreate'                  : false,
                        'fieldBazPostOnUpdate'                  : false
                    ]
                )}}
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col">
        {{adminltetags.useTag('buttons',
            [
                'component'                 : component,
                'componentName'             : componentName,
                'componentId'               : componentId,
                'sectionId'                 : sectionId,
                'buttonType'                : 'button',
                'buttons'                   :
                    {
                        'pwreset-button' : {
                            'title'                   : 'Reset',
                            'size'                    : 'sm',
                            'type'                    : 'primary',
                            'icon'                    : 'cog fa-spin',
                            'iconHidden'              : true,
                            'position'                : 'right'
                        }
                    }
            ]
        )}}
    </div>
</div>
<script>
/* global PNotify */
var pwresetUrl, pwresetData;

$('#{{componentId}}-{{sectionId}}-pwreset-button').click(function(e) {
    e.preventDefault();

    pwresetUrl = '{{links.url("users/profile/pwreset")}}';

    pwresetData = {
        'pass'              : $('#{{componentId}}-{{sectionId}}-current_password').val().trim(),
        'newpass'           : $('#{{componentId}}-{{sectionId}}-new_password').val().trim(),
        'confirmnewpass'    : $('#{{componentId}}-{{sectionId}}-confirm_password').val().trim()
    }
    pwresetData[$('#security-token').attr('name')] = $('#security-token').val();

    $.post(pwresetUrl, pwresetData, function(response) {
        if (response.responseCode == 0) {
            if (response.redirectUrl) {
                window.location = response.redirectUrl;
            }
        } else {
            PNotify.error(response.responseMessage);
        }
        if (response.tokenKey && response.token) {
            $("#security-token").attr("name", response.tokenKey);
            $("#security-token").val(response.token);
        }
    }, 'json');
});
</script>