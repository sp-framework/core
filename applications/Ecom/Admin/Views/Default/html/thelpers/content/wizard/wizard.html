{% set truncated = '' %}
{% if wizardType == 'vertical' %}
    {% set type = 'wizard vertical' %}
    {% set truncated = 'text-truncate' %}
{% elseif wizardType == 'triangle' %}
    {% set type = 'wizard triangle'%}
{% elseif wizardType == 'multi-text-center' %}
    {% set type = 'wizard multi-steps text-center' %}
{% elseif wizardType == 'multi-text-top' %}
    {% set type = 'wizard multi-steps text-top' %}
{% elseif wizardType == 'multi-text-bottom' %}
    {% set type = 'wizard multi-steps text-bottom' %}
{% elseif wizardType == 'multi-count-text-top' %}
    {% set type = 'wizard multi-steps text-top count' %}
{% elseif wizardType == 'multi-count-text-bottom' %}
    {% set type = 'wizard multi-steps text-bottom count' %}
{% else %}
    {% set type = 'wizard' %}
{% endif %}

{% set lis = '' %}
{% set description = '' %}
{% set data = '' %}

{% if wizardShowReview %}
    {% set wizardSteps = wizardSteps|merge({(wizardSteps|length + 1) : {'title': 'Review'}}) %}
{% endif %}

{% for wizardStepKey, wizardStep in wizardSteps %}
    {% if wizardType == 'vertical' %}
        {% if wizardStep.icon %}
            {% set lis = 
                lis ~ 
                '<li id="' ~ componentId ~ '-' ~ sectionId ~ '-' ~ wizardStepKey ~ '-step" class="">
                    <span class="' ~ truncated ~ '">
                        <i class="fas fa-fw fa-' ~ wizardStep.icon ~ ' mr-1"></i>' ~ 
                            wizardStep.title ~
                        '</span>' ~
                    '</li>' %}
        {% else %}
            {% set lis = 
                lis ~ 
                '<li id="' ~ componentId ~ '-' ~ sectionId ~ '-' ~ wizardStepKey ~ '-step" class="">
                    <span>' ~ wizardStep.title ~ '</span>
                </li>' %}
        {% endif %}
    {% else %}
        {% if wizardStep.icon %}
            {% set lis = 
                lis ~ 
                '<li id="' ~ componentId ~ '-' ~ sectionId ~ '-' ~ wizardStepKey ~ '-step" class="">
                    <span>
                        <i class="fas fa-fw fa-' ~ wizardStep.icon ~ ' mr-1"></i>' ~ wizardStep.title ~ 
                    '</span>
                </li>' %}
        {% else %}
            {% set lis = lis ~ '<li id="' ~ componentId ~ '-' ~ sectionId ~ '-' ~ wizardStepKey ~ '-step" class=""><span>' ~ wizardStep.title ~ '</span></li>' %}
        {% endif %}
    {% endif %}
    {% if wizardStep.description %}
        {% set description = 
            description ~ 
            '<div class="rounded-0 callout callout-info" id="' ~ componentId ~ '-' ~ sectionId ~ '-' ~ wizardStepKey ~ '-description" hidden>' ~ 
                wizardStep.description ~ 
            '</div>'
        %}
    {% endif %}
    {% if wizardStep.include %}
        {% set data = data ~ 
            '<div id="' ~ componentId ~ '-' ~ sectionId ~ '-' ~ wizardStepKey ~ '-data" hidden>' ~ include(wizardStep.include) ~ '</div>'
        %}
    {% elseif wizardStep.route %}
        {% set data = data ~ 
            '<div id="' ~ componentId ~ '-' ~ sectionId ~ '-' ~ wizardStepKey ~ '-data" hidden>' ~ route(wizardStep.route) ~ '</div>'
        %}
    {% elseif wizardStep.ajax %}
        {% set data = data ~ 
            '<div id="' ~ componentId ~ '-' ~ sectionId ~ '-' ~ wizardStepKey ~ '-data" hidden></div>'
        %}        
    {% elseif wizardStep.content %}
        {% set data = data ~ 
            '<div id="' ~ componentId ~ '-' ~ sectionId ~ '-' ~ wizardStepKey ~ '-data" hidden>' ~ 
                '<div class="card">
                    <div class="card-body">' ~
                        wizardStep.content ~ 
                    '</div>
                </div>
            </div>'
        %}
    {% endif %}
{% endfor %}
{% if wizardShowReview %}
    {% set description = 
        description ~ 
        '<div class="rounded-0 callout callout-info" id="' ~ componentId ~ '-' ~ sectionId ~ '-' ~ (wizardSteps|length - 1) ~ '-description" hidden>'
            ~ wizardReviewDescription ~
        '</div>' %}
    {% set data = data ~ 
        '<div id="' ~ componentId ~ '-' ~ sectionId ~ '-' ~ (wizardSteps|length - 1) ~ '-data" hidden></div>'
    %}        
{% endif %}
{% if wizardType == 'vertical' %}
    <div class="row" id="{{componentId}}-{{sectionId}}-steps">
        <div class="col-md-2">
            <ol class="{{type}}">
                {{lis|raw}}
            </ol>
        </div>
        <div class="col-md-10">
            <div class="row">
                <div class="col">
                    {{description|raw}}
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <div id="{{componentId}}-{{sectionId}}-data">{{data|raw}}</div>
                </div>
            </div>
        </div>
    </div>
{% else %}
    <div class="row" id="{{componentId}}-{{sectionId}}-steps">
        <div class="col">
            <ol class="{{type}}">
                {{lis|raw}}
            </ol>
        </div>
    </div>
    <div class="row">
        <div class="col">
            {{description|raw}}
        </div>
    </div>
    <div class="row">
        <div class="col">
            <div id="{{componentId}}-{{sectionId}}-data">{{data|raw}}</div>
        </div>
    </div>
{% endif %}
<script>
if (!window['bazDataCollection']['{{componentId}}']) {
    window['bazDataCollection']['{{componentId}}'] = { };
}
window['bazDataCollection']['{{componentId}}']['{{componentId}}-{{sectionId}}'] = 
    $.extend(window['bazDataCollection']['{{componentId}}']['{{componentId}}-{{sectionId}}'], {
        'showReview'                    : '{{wizardShowReview}}',
        'canCancel'                     : '{{wizardCanCancel}}',
        'steps'                         : JSON.parse('{{wizardSteps|json_encode|e("js")}}'),
    });
</script>