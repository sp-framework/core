{% set tabsData =
    [
        'info'   :
        [
            'tabTitle'          : 'Info',
            'tabInclude'        : 'modules/module/info'
        ]
    ]
%}
{% if module is defined and module['module_type'] === 'components' or type === 'components' %}
    {% set tabsData = array_merge(tabsData,
        [
            'menu'   :
            [
                'tabTitle'          : 'Menu',
                'tabInclude'        : 'modules/module/menu'
            ]
        ])
    %}
{% endif %}
{% set tabsData = array_merge(tabsData,
    [
        'settings'   :
        [
            'tabTitle'          : 'Settings',
            'tabInclude'        : 'modules/module/settings'
        ]
    ],
    [
        'dependencies'   :
            [
                'tabTitle'          : 'Dependencies',
                'tabInclude'        : 'modules/module/dependencies'
            ]
    ])
%}
<form data-validateon="section" id="{{componentId}}-{{sectionId}}-form">
    <fieldset id="{{componentId}}-{{sectionId}}-fieldset">
        {{adminltetags.useTag('tabs',
            [
                'component'                     : component,
                'componentName'                 : componentName,
                'componentId'                   : componentId,
                'sectionId'                     : 'main',
                'tabsId'                        : 'tabs',
                'tabsStyle'                     : 'card-outline-tabs',
                'tabsData'                      : tabsData
            ]
        )}}
    </fieldset>
</form>
<script>
var dataCollectionComponent, dataCollectionSection, dataCollectionSectionForm;

if (!window['dataCollection']['{{componentId}}']) {
    dataCollectionComponent =
        window['dataCollection']['{{componentId}}'] = { };
} else {
    dataCollectionComponent =
        window['dataCollection']['{{componentId}}'];
}
if (!dataCollectionComponent['{{componentId}}-{{sectionId}}']) {
    dataCollectionSection =
        dataCollectionComponent['{{componentId}}-{{sectionId}}'] = { };
} else {
    dataCollectionSection =
        dataCollectionComponent['{{componentId}}-{{sectionId}}'];
}
if (!dataCollectionSection['{{componentId}}-{{sectionId}}-form']) {
    dataCollectionSectionForm =
        dataCollectionSection['{{componentId}}-{{sectionId}}-form'] = { };
} else {
    dataCollectionSectionForm =
        dataCollectionSection['{{componentId}}-{{sectionId}}-form'];
}

dataCollectionSectionForm['vars'] = { };
dataCollectionSectionForm['vars']['modules'] = JSON.parse('{{modulesJson}}');
dataCollectionSectionForm['vars']['moduleDependencies'] = JSON.parse('{{moduleDependencies}}');
dataCollectionSectionForm['vars']['moduleSettings'] = JSON.parse('{{moduleSettings}}');
if (!dataCollectionSectionForm['vars']['moduleDependencies']['external']) {
    dataCollectionSectionForm['vars']['moduleDependencies']['external'] = { };
}

dataCollectionSection =
    $.extend(dataCollectionSection, {
        '{{componentId}}-{{sectionId}}-id'                                  : { },
        '{{componentId}}-{{sectionId}}-type'                                : { },
        '{{componentId}}-{{sectionId}}-name'                                : { },
        '{{componentId}}-{{sectionId}}-display_name'                        : { },
        '{{componentId}}-{{sectionId}}-route'                               : { },
        '{{componentId}}-{{sectionId}}-description'                         : { },
        '{{componentId}}-{{sectionId}}-module_type'                         : {
            'placeholder'   : 'SELECT MODULE TYPE'
        },
        '{{componentId}}-{{sectionId}}-app_type'                            : {
            'placeholder'   : 'SELECT APP TYPE OR CREATE NEW'
        },
        '{{componentId}}-{{sectionId}}-category'                            : {
            'placeholder'   : 'SELECT CATEGORY'
        },
        '{{componentId}}-{{sectionId}}-api_id'                              : {
            'placeholder'   : 'SELECT LOCAL OR REMOTE REPOSITORY',
            afterInit: function() {
                $('#{{componentId}}-{{sectionId}}-api_id').on('select2:select', function(e) {
                    var id, repourl, currenturl, currenturlArr, name, lastCharOfRepourl, moduleRepoUrl;

                    id = e.params.data.id;
                    repourl = $(e.params.data.element).data('url');
                    currenturl = $('#{{componentId}}-{{sectionId}}-repo').val();

                    lastCharOfRepourl = repourl.substr(repourl.length - 1);

                    if (currenturl !== '') {
                        currenturlArr = currenturl.split('/');
                        name = currenturlArr[currenturlArr.length - 1];
                        moduleRepoUrl = repourl.toLowerCase() + name.toLowerCase();
                        if (lastCharOfRepourl !== '/') {
                            moduleRepoUrl = repourl.toLowerCase() + '/' + name.toLowerCase();
                        }
                        $('#{{componentId}}-{{sectionId}}-repo').val(moduleRepoUrl);
                    } else {
                        if (lastCharOfRepourl !== '/') {
                            $('#{{componentId}}-{{sectionId}}-repo').val(repourl + '/');
                        } else {
                            $('#{{componentId}}-{{sectionId}}-repo').val(repourl);
                        }
                    }
                });
            }
        },
        '{{componentId}}-{{sectionId}}-version'                             : { },
        '{{componentId}}-{{sectionId}}-repo'                                : { },
        '{{componentId}}-{{sectionId}}-class'                               : { },
        '{{componentId}}-{{sectionId}}-settings'                            : {
            'afterInit'     : function() {
                if (dataCollectionSectionForm['vars']['moduleSettings'].length === 0) {
                    dataCollectionSectionForm['vars']['moduleSettings'] = { };
                }
                function prettyfyJson() {
                    $('#{{componentId}}-{{sectionId}}-settings')
                        .val(JSON.stringify(dataCollectionSectionForm['vars']['moduleSettings'], null, 4));
                }

                //Components - Mandatory, NeedAuth, ImportExportPackage
                if (dataCollectionSectionForm['vars']['moduleSettings']['mandatory'] !== 'undefined') {
                    if (dataCollectionSectionForm['vars']['moduleSettings']['mandatory'] === true) {
                        $("#forAppType").prop('checked', true);
                    } else if (typeof dataCollectionSectionForm['vars']['moduleSettings']['mandatory'] === 'object') {
                        $("#forApp").prop('checked', true);
                        $("#{{componentId}}-{{sectionId}}-mandatory-apps").attr('disabled', false);
                        $("#{{componentId}}-{{sectionId}}-mandatory-apps")
                            .val(Object.keys(dataCollectionSectionForm['vars']['moduleSettings']['mandatory']).join(','));
                    }
                } else {
                    $("#mandatory-no").prop('checked', true);
                }

                $('#{{componentId}}-{{sectionId}}-mandatory').off();
                $('#{{componentId}}-{{sectionId}}-mandatory').click(function() {
                    if ($(this).find('input[type=radio]:checked').data('value') == 'mandatory-no') {
                        if (dataCollectionSectionForm['vars']['moduleSettings']['mandatory']) {
                            delete dataCollectionSectionForm['vars']['moduleSettings']['mandatory'];
                        }
                        $("#{{componentId}}-{{sectionId}}-mandatory-apps").attr('disabled', true);
                        $("#{{componentId}}-{{sectionId}}-mandatory-apps").val('');
                    } else if ($(this).find('input[type=radio]:checked').data('value') == 'forAppType') {
                        dataCollectionSectionForm['vars']['moduleSettings']['mandatory'] = true;
                        $("#{{componentId}}-{{sectionId}}-mandatory-apps").attr('disabled', true);
                        $("#{{componentId}}-{{sectionId}}-mandatory-apps").val('');
                    } else if ($(this).find('input[type=radio]:checked').data('value') == 'forApp') {
                        dataCollectionSectionForm['vars']['moduleSettings']['mandatory'] = { };
                        $("#{{componentId}}-{{sectionId}}-mandatory-apps").attr('disabled', false);
                    }
                });

                $('#{{componentId}}-{{sectionId}}-need-auth').off();
                $('#{{componentId}}-{{sectionId}}-need-auth').click(function() {
                    if ($(this).find('input[type=radio]:checked').data('value') == 'need-auth-default') {
                        if (dataCollectionSectionForm['vars']['moduleSettings']['needAuth']) {
                            delete dataCollectionSectionForm['vars']['moduleSettings']['needAuth'];
                        }
                    } else if ($(this).find('input[type=radio]:checked').data('value') == 'need-auth-yes') {
                        dataCollectionSectionForm['vars']['moduleSettings']['needAuth'] = true;
                    } else if ($(this).find('input[type=radio]:checked').data('value') == 'need-auth-mandatory') {
                        dataCollectionSectionForm['vars']['moduleSettings']['needAuth'] = 'mandatory';
                    } else if ($(this).find('input[type=radio]:checked').data('value') == 'need-auth-disabled') {
                        dataCollectionSectionForm['vars']['moduleSettings']['needAuth'] = 'disabled';
                    }
                });

                if (dataCollectionSectionForm['vars']['moduleSettings']['needAuth'] !== 'undefined') {
                    if (dataCollectionSectionForm['vars']['moduleSettings']['needAuth'] === true) {
                        $("#need-auth-yes").prop('checked', true);
                    } else if (dataCollectionSectionForm['vars']['moduleSettings']['needAuth'] === 'mandatory') {
                        $("#need-auth-mandatory").prop('checked', true);
                    } else if (dataCollectionSectionForm['vars']['moduleSettings']['needAuth'] === 'disabled') {
                        $("#need-auth-disabled").prop('checked', true);
                    }
                } else {
                    $("#need-auth-default").prop('checked', true);
                }

                $('#{{componentId}}-{{sectionId}}-settings-packages').on('select2:select', function(e) {
                    if ($(e.params.data.element).data('importexportpackage')) {
                        dataCollectionSectionForm['vars']['moduleSettings']['importExportPackage'] = $(e.params.data.element).data('importexportpackage');
                    }
                });
                $('#{{componentId}}-{{sectionId}}-settings-packages').on('select2:clear', function(e) {
                    delete dataCollectionSectionForm['vars']['moduleSettings']['importExportPackage'];
                });
                if (dataCollectionSectionForm['vars']['moduleSettings']['importExportPackage']) {
                    $('#{{componentId}}-{{sectionId}}-settings-packages').find("option").each(function(i, option) {
                        if ($(option).data('importexportpackage') === dataCollectionSectionForm['vars']['moduleSettings']['importExportPackage']) {
                            $('#{{componentId}}-{{sectionId}}-settings-packages').val($(option).data('value')).trigger('change');
                        }
                    });
                }

                //Packages - Export, Import, ImportAddMethod, ImportUpdateMethod
                $('#{{componentId}}-{{sectionId}}-settings-components').on('select2:select', function(e) {
                    if ($(e.params.data.element).data('route')) {
                        dataCollectionSectionForm['vars']['moduleSettings']['componentRoute'] = $(e.params.data.element).data('route');
                    }
                });
                $('#{{componentId}}-{{sectionId}}-settings-components').on('select2:clear', function(e) {
                    delete dataCollectionSectionForm['vars']['moduleSettings']['componentRoute'];
                });
                if (dataCollectionSectionForm['vars']['moduleSettings']['componentRoute']) {
                    $('#{{componentId}}-{{sectionId}}-settings-components').find("option").each(function(i, option) {
                        if ($(option).data('route') === dataCollectionSectionForm['vars']['moduleSettings']['componentRoute']) {
                            $('#{{componentId}}-{{sectionId}}-settings-components').val($(option).data('value')).trigger('change');
                        }
                    });
                }
                if (dataCollectionSectionForm['vars']['moduleSettings']['import'] !== 'undefined' &&
                    dataCollectionSectionForm['vars']['moduleSettings']['import'] == true
                ) {
                    $('#{{componentId}}-{{sectionId}}-import')[0].checked = true;
                } else {
                    $('#{{componentId}}-{{sectionId}}-import-add-method, ' +
                      '#{{componentId}}-{{sectionId}}-import-update-method').attr('disabled', true);
                }
                if (dataCollectionSectionForm['vars']['moduleSettings']['export'] !== 'undefined' &&
                    dataCollectionSectionForm['vars']['moduleSettings']['export'] == true
                ) {
                    $('#{{componentId}}-{{sectionId}}-export')[0].checked = true;
                }
                if (dataCollectionSectionForm['vars']['moduleSettings']['importAddMethod']) {
                    $('#{{componentId}}-{{sectionId}}-import-add-method').val(dataCollectionSectionForm['vars']['moduleSettings']['importAddMethod']);
                }
                if (dataCollectionSectionForm['vars']['moduleSettings']['importUpdateMethod']) {
                    $('#{{componentId}}-{{sectionId}}-import-update-method').val(dataCollectionSectionForm['vars']['moduleSettings']['importUpdateMethod']);
                }
                $('#{{componentId}}-{{sectionId}}-import').off();
                $('#{{componentId}}-{{sectionId}}-import').click(function() {
                    if ($(this)[0].checked === true) {
                        dataCollectionSectionForm['vars']['moduleSettings']['import'] = true;
                        $('#{{componentId}}-{{sectionId}}-import-add-method, ' +
                          '#{{componentId}}-{{sectionId}}-import-update-method').attr('disabled', false);
                    } else {
                        delete dataCollectionSectionForm['vars']['moduleSettings']['import'];
                        delete dataCollectionSectionForm['vars']['moduleSettings']['importAddMethod'];
                        delete dataCollectionSectionForm['vars']['moduleSettings']['importUpdateMethod'];
                        $('#{{componentId}}-{{sectionId}}-import-add-method, ' +
                          '#{{componentId}}-{{sectionId}}-import-update-method').attr('disabled', true);
                        $('#{{componentId}}-{{sectionId}}-import-add-method, ' +
                          '#{{componentId}}-{{sectionId}}-import-update-method').val('');
                    }
                });
                $('#{{componentId}}-{{sectionId}}-export').off();
                $('#{{componentId}}-{{sectionId}}-export').click(function() {
                    if ($(this)[0].checked === true) {
                        dataCollectionSectionForm['vars']['moduleSettings']['export'] = true;
                    } else {
                        delete dataCollectionSectionForm['vars']['moduleSettings']['export'];
                    }
                });


                $('#{{componentId}}-{{sectionId}}-generate-settings').off();
                $('#{{componentId}}-{{sectionId}}-generate-settings').click(function() {
                    if ($($('#{{componentId}}-{{sectionId}}-module_type').find(':selected')[0]).val() === 'components' ||
                        $($('#{{componentId}}-{{sectionId}}-module_type').find(':selected')[0]).val() === 'middlewares'
                    ) {
                        if (typeof dataCollectionSectionForm['vars']['moduleSettings']['mandatory'] === 'object') {
                            if ($('#{{componentId}}-{{sectionId}}-mandatory-apps').val() === '') {
                                $('#{{componentId}}-{{sectionId}}-mandatory-apps').addClass('is-invalid');
                                $('#{{componentId}}-{{sectionId}}-mandatory-apps').focus(function() {
                                    $(this).removeClass('is-invalid');
                                });
                            } else {
                                var apps = $('#{{componentId}}-{{sectionId}}-mandatory-apps').val().split(',');

                                $(apps).each(function(i, app) {
                                    dataCollectionSectionForm['vars']['moduleSettings']['mandatory'][app.trim()] = true;
                                });
                                prettyfyJson();
                            }
                        } else {
                            prettyfyJson();
                        }
                    } else if ($($('#{{componentId}}-{{sectionId}}-module_type').find(':selected')[0]).val() === 'packages') {
                        if ($('#{{componentId}}-{{sectionId}}-import')[0].checked === true) {
                            if ($('#{{componentId}}-{{sectionId}}-import-add-method').val() === '') {
                                $('#{{componentId}}-{{sectionId}}-import-add-method').addClass('is-invalid');
                                $('#{{componentId}}-{{sectionId}}-import-add-method').focus(function() {
                                    $(this).removeClass('is-invalid');
                                });
                            } else if ($('#{{componentId}}-{{sectionId}}-import-update-method').val() === '') {
                                $('#{{componentId}}-{{sectionId}}-import-update-method').addClass('is-invalid');
                                $('#{{componentId}}-{{sectionId}}-import-update-method').focus(function() {
                                    $(this).removeClass('is-invalid');
                                });
                            } else {
                                dataCollectionSectionForm['vars']['moduleSettings']['importAddMethod']
                                    = $('#{{componentId}}-{{sectionId}}-import-add-method').val();
                                dataCollectionSectionForm['vars']['moduleSettings']['importUpdateMethod']
                                    = $('#{{componentId}}-{{sectionId}}-import-update-method').val();
                                prettyfyJson();
                            }
                        } else {
                            prettyfyJson();
                        }
                    }
                });
                prettyfyJson();
            }
        },
        '{{componentId}}-{{sectionId}}-menu'                                : { },
        '{{componentId}}-{{sectionId}}-menu_id'                             : { },
        '{{componentId}}-{{sectionId}}-apps'                                : { },
        '{{componentId}}-{{sectionId}}-settings-components'                 : {
            'placeholder'   : 'SELECT COMPONENT',
            'allowClear'    : true
        },
        '{{componentId}}-{{sectionId}}-mandatory'                           : { },
        '{{componentId}}-{{sectionId}}-mandatory-apps'                      : { },
        '{{componentId}}-{{sectionId}}-need-auth'                           : { },
        '{{componentId}}-{{sectionId}}-settings-packages'                   : {
            'placeholder'   : 'SELECT PACKAGE',
            'allowClear'    : true
        },
        '{{componentId}}-{{sectionId}}-settings-keys'                           : {
            placeholder: "SELECT SETTING TO MODIFY OR ADD",
            afterInit: function() {
                var keys =
                    [
                        {
                            'body-jsscript' : {
                                'id'    : 'body-jsscript',
                                'text'  : 'Body Inline Java Script'
                            }
                        },
                        {
                            'head-link-href' : {
                                'id'    : 'head-link-href',
                                'text'  : 'Head CSS Links'
                            }
                        },
                        {
                            'head-meta-author' : {
                                'id'    : 'head-meta-author',
                                'text'  : 'Head Meta Author'
                            }
                        },
                        {
                            'head-meta-charset' : {
                                'id'    : 'head-meta-charset',
                                'text'  : 'Head Meta Charset'
                            }
                        },
                        {
                            'head-meta-keywords' : {
                                'id'    : 'head-meta-keywords',
                                'text'  : 'Head Meta Keywords'
                            }
                        },
                        {
                            'head-meta-viewport' : {
                                'id'    : 'head-meta-viewport',
                                'text'  : 'Head Meta Viewport'
                            }
                        },
                        {
                            'head-meta-description' : {
                                'id'    : 'head-meta-description',
                                'text'  : 'Head Meta Description'
                            }
                        },
                        {
                            'title' : {
                                'id'    : 'title',
                                'text'  : 'Site Title'
                            }
                        },
                        {
                            'script-src' : {
                                'id'    : 'script-src',
                                'text'  : 'Head Java Scripts Source'
                            }
                        },
                        {
                            'tags' : {
                                'id'    : 'tags',
                                'text'  : 'HTML Tags'
                            }
                        },
                        {
                            'footer-script-src' : {
                                'id'    : 'footer-script-src',
                                'text'  : 'Footer Java Scripts Source'
                            }
                        },
                        {
                            'footer-jsscript' : {
                                'id'    : 'footer-jsscript',
                                'text'  : 'Footer Inline Java Script'
                            }
                        },
                        {
                            'footer-copyright-name' : {
                                'id'    : 'footer-copyright-name',
                                'text'  : 'Footer Copyright Name'
                            }
                        },
                        {
                            'footer-copyright-site' : {
                                'id'    : 'footer-copyright-site',
                                'text'  : 'Footer Copyright Website'
                            }
                        },
                        {
                            'footer-copyright-fromYear' : {
                                'id'    : 'footer-copyright-fromYear',
                                'text'  : 'Footer Copyright From Year'
                            }
                        },
                        {
                            'layouts' : {
                                'id'    : 'layouts',
                                'text'  : 'Layouts'
                            }
                        },
                        {
                            'mandatory' : {
                                'id'    : 'mandatory',
                                'text'  : 'View Mandatory'
                            }
                        }
                    ];

                $(keys).each(function(e, key) {
                    for (var keyId in key) {
                        var newOption = new Option(key[keyId].text, key[keyId].id, false, false);
                        $('#{{componentId}}-{{sectionId}}-settings-keys').append(newOption).trigger('change');
                    }
                });

                var key, settings, fieldType, type;

                $('#{{componentId}}-{{sectionId}}-settings-keys').on('select2:select', function(e) {
                    $('#settings-text').attr('hidden', true);
                    $('#settings-textarea').attr('hidden', true);
                    $('#settings-select').attr('hidden', true);

                    key = e.params.data.id;

                    switch (key) {
                        case 'body-jsscript' :
                            type = 'textarea';
                            settings = '';

                            if (dataCollectionSectionForm['vars']['moduleSettings']['body']['jsscript']) {
                                settings = dataCollectionSectionForm['vars']['moduleSettings']['body']['jsscript'];
                            }

                            break;
                        case 'head-link-href' :
                            type = 'array';
                            settings = '';

                            if (dataCollectionSectionForm['vars']['moduleSettings']['head']['link']['href']) {
                                settings = dataCollectionSectionForm['vars']['moduleSettings']['head']['link']['href'];
                            }

                            break;
                        case 'head-meta-author' :
                            type = 'text';
                            settings = '';

                            if (dataCollectionSectionForm['vars']['moduleSettings']['head']['meta']['author']) {
                                settings = dataCollectionSectionForm['vars']['moduleSettings']['head']['meta']['author'];
                            }

                            break;
                        case 'head-meta-charset' :
                            type = 'text';
                            settings = '';

                            if (dataCollectionSectionForm['vars']['moduleSettings']['head']['meta']['charset']) {
                                settings = dataCollectionSectionForm['vars']['moduleSettings']['head']['meta']['charset'];
                            }

                            break;
                        case 'head-meta-keywords' :
                            type = 'text';
                            settings = '';

                            if (dataCollectionSectionForm['vars']['moduleSettings']['head']['meta']['keywords']) {
                                settings = dataCollectionSectionForm['vars']['moduleSettings']['head']['meta']['keywords'];
                            }

                            break;
                        case 'head-meta-viewport' :
                            type = 'text';
                            settings = '';

                            if (dataCollectionSectionForm['vars']['moduleSettings']['head']['meta']['viewport']) {
                                settings = dataCollectionSectionForm['vars']['moduleSettings']['head']['meta']['viewport'];
                            }

                            break;
                        case 'head-meta-description' :
                            type = 'text';
                            settings = '';

                            if (dataCollectionSectionForm['vars']['moduleSettings']['head']['meta']['description']) {
                                settings = dataCollectionSectionForm['vars']['moduleSettings']['head']['meta']['description'];
                            }

                            break;
                        case 'title' :
                            type = 'text';
                            settings = '';

                            if (dataCollectionSectionForm['vars']['moduleSettings']['head']['title']) {
                                settings = dataCollectionSectionForm['vars']['moduleSettings']['head']['title'];
                            }

                            break;
                        case 'script-src' :
                            type = 'array';
                            settings = '';

                            if (dataCollectionSectionForm['vars']['moduleSettings']['head']['script']['src']) {
                                settings = dataCollectionSectionForm['vars']['moduleSettings']['head']['script']['src'];
                            }

                            break;
                        case 'tags' :
                            type = 'text';
                            settings = '';

                            if (dataCollectionSectionForm['vars']['moduleSettings']['tags']) {
                                settings = dataCollectionSectionForm['vars']['moduleSettings']['tags'];
                            }

                            break;
                        case 'footer-script-src' :
                            type = 'textarea';
                            settings = '';

                            if (dataCollectionSectionForm['vars']['moduleSettings']['footer']['script']['src']) {
                                settings = dataCollectionSectionForm['vars']['moduleSettings']['footer']['script']['src'];
                            }

                            break;
                        case 'footer-jsscript' :
                            type = 'textarea';
                            settings = '';

                            if (dataCollectionSectionForm['vars']['moduleSettings']['footer']['jsscript']) {
                                settings = dataCollectionSectionForm['vars']['moduleSettings']['footer']['jsscript'];
                            }

                            break;
                        case 'footer-copyright-name' :
                            type = 'text';
                            settings = '';

                            if (dataCollectionSectionForm['vars']['moduleSettings']['footer']['copyright']['name']) {
                                settings = dataCollectionSectionForm['vars']['moduleSettings']['footer']['copyright']['name'];
                            }

                            break;
                        case 'footer-copyright-site' :
                            type = 'text';
                            settings = '';

                            if (dataCollectionSectionForm['vars']['moduleSettings']['footer']['copyright']['site']) {
                                settings = dataCollectionSectionForm['vars']['moduleSettings']['footer']['copyright']['site'];
                            }

                            break;
                        case 'footer-copyright-fromYear' :
                            type = 'text';
                            settings = '';

                            if (dataCollectionSectionForm['vars']['moduleSettings']['footer']['copyright']['fromYear']) {
                                settings = dataCollectionSectionForm['vars']['moduleSettings']['footer']['copyright']['fromYear'];
                            }

                            break;
                        case 'layouts' :
                            type = 'array';
                            settings = '';

                            if (dataCollectionSectionForm['vars']['moduleSettings']['layouts']) {
                                settings = dataCollectionSectionForm['vars']['moduleSettings']['layouts'];
                            }

                            break;
                        case 'mandatory' :
                            type = 'boolean';
                            settings = '';

                            if (dataCollectionSectionForm['vars']['moduleSettings']['mandatory']) {
                                settings = dataCollectionSectionForm['vars']['moduleSettings']['mandatory'];
                            }

                            break;
                    }
                    //eslint-disable-next-line
                    console.log(type, settings);
                    if (type === 'text' || type === 'boolean') {
                        $('#{{componentId}}-{{sectionId}}-settings-text').val(settings);

                        fieldType = 'text';
                    } else if (type === 'textarea') {
                        $('#{{componentId}}-{{sectionId}}-settings-textarea').val(settings);
                        fieldType = 'textarea';
                    } else if (type === 'array') {
                        $('#{{componentId}}-{{sectionId}}-settings-textarea').val(JSON.stringify(settings, null, 4));

                        fieldType = 'textarea';
                    }

                    $('#settings-' + fieldType).attr('hidden', false);
                    $('#{{componentId}}-{{sectionId}}-save').attr('disabled', false);
                    $('#{{componentId}}-{{sectionId}}-cancel').attr('disabled', false);
                });

                $('#{{componentId}}-{{sectionId}}-cancel').off();
                $('#{{componentId}}-{{sectionId}}-cancel').click(function(e) {
                    e.preventDefault();

                    $('#{{componentId}}-{{sectionId}}-settings-' + fieldType).val('');
                    $('#settings-' + fieldType).attr('hidden', true);
                    $('#{{componentId}}-{{sectionId}}-save').attr('disabled', true);
                    $('#{{componentId}}-{{sectionId}}-cancel').attr('disabled', true);
                    $('#{{componentId}}-{{sectionId}}-settings-keys').val(0).trigger('change');
                });

                $('#{{componentId}}-{{sectionId}}-save').off();
                $('#{{componentId}}-{{sectionId}}-save').click(function(e) {
                    e.preventDefault();

                    switch (key) {
                        case 'body-jsscript' :
                            dataCollectionSectionForm['vars']['moduleSettings']['body']['jsscript']
                                = $('#{{componentId}}-{{sectionId}}-settings-' + fieldType).val();

                            break;
                        case 'head-link-href' :
                            dataCollectionSectionForm['vars']['moduleSettings']['head']['link']['href']
                                 = JSON.parse($('#{{componentId}}-{{sectionId}}-settings-' + fieldType).val());

                            break;
                        case 'head-meta-author' :
                            dataCollectionSectionForm['vars']['moduleSettings']['head']['meta']['author']
                                = $('#{{componentId}}-{{sectionId}}-settings-' + fieldType).val();

                            break;
                        case 'head-meta-charset' :
                            dataCollectionSectionForm['vars']['moduleSettings']['head']['meta']['charset']
                                = $('#{{componentId}}-{{sectionId}}-settings-' + fieldType).val();

                            break;
                        case 'head-meta-keywords' :
                            dataCollectionSectionForm['vars']['moduleSettings']['head']['meta']['keywords']
                                = $('#{{componentId}}-{{sectionId}}-settings-' + fieldType).val();

                            break;
                        case 'head-meta-viewport' :
                            dataCollectionSectionForm['vars']['moduleSettings']['head']['meta']['viewport']
                                = $('#{{componentId}}-{{sectionId}}-settings-' + fieldType).val();

                            break;
                        case 'head-meta-description' :
                            dataCollectionSectionForm['vars']['moduleSettings']['head']['meta']['description']
                                = $('#{{componentId}}-{{sectionId}}-settings-' + fieldType).val();

                            break;
                        case 'title' :
                            dataCollectionSectionForm['vars']['moduleSettings']['head']['title']
                                = $('#{{componentId}}-{{sectionId}}-settings-' + fieldType).val();

                            break;
                        case 'script-src' :
                            dataCollectionSectionForm['vars']['moduleSettings']['head']['script']['src']
                                 = JSON.parse($('#{{componentId}}-{{sectionId}}-settings-' + fieldType).val());

                            break;
                        case 'tags' :
                            dataCollectionSectionForm['vars']['moduleSettings']['tags']
                                = $('#{{componentId}}-{{sectionId}}-settings-' + fieldType).val();

                            break;
                        case 'footer-script-src' :
                            dataCollectionSectionForm['vars']['moduleSettings']['footer']['script']['src']
                                = $('#{{componentId}}-{{sectionId}}-settings-' + fieldType).val();

                            break;
                        case 'footer-jsscript' :
                            dataCollectionSectionForm['vars']['moduleSettings']['footer']['jsscript']
                                = $('#{{componentId}}-{{sectionId}}-settings-' + fieldType).val();

                            break;
                        case 'footer-copyright-name' :
                            dataCollectionSectionForm['vars']['moduleSettings']['footer']['copyright']['name']
                                = $('#{{componentId}}-{{sectionId}}-settings-' + fieldType).val();

                            break;
                        case 'footer-copyright-site' :
                            dataCollectionSectionForm['vars']['moduleSettings']['footer']['copyright']['site']
                                = $('#{{componentId}}-{{sectionId}}-settings-' + fieldType).val();

                            break;
                        case 'footer-copyright-fromYear' :
                            dataCollectionSectionForm['vars']['moduleSettings']['footer']['copyright']['fromYear']
                                = $('#{{componentId}}-{{sectionId}}-settings-' + fieldType).val();

                            break;
                        case 'layouts' :
                            dataCollectionSectionForm['vars']['moduleSettings']['layouts']
                                = JSON.parse($('#{{componentId}}-{{sectionId}}-settings-' + fieldType).val());

                            break;
                        case 'mandatory' :
                            dataCollectionSectionForm['vars']['moduleSettings']['mandatory']
                                = JSON.parse($('#{{componentId}}-{{sectionId}}-settings-' + fieldType).val());

                            break;
                    }

                    $('#{{componentId}}-{{sectionId}}-settings')
                        .val(JSON.stringify(dataCollectionSectionForm['vars']['moduleSettings'], null, 4));

                    $('#{{componentId}}-{{sectionId}}-settings-' + fieldType).val('');
                    $('#settings-' + fieldType).attr('hidden', true);
                    $('#{{componentId}}-{{sectionId}}-save').attr('disabled', true);
                    $('#{{componentId}}-{{sectionId}}-cancel').attr('disabled', true);
                    $('#{{componentId}}-{{sectionId}}-settings-keys').val(0).trigger('change');
                });
            }
        },
        '{{componentId}}-{{sectionId}}-settings-text'                           : { },
        '{{componentId}}-{{sectionId}}-settings-textarea'                       : { },
        '{{componentId}}-{{sectionId}}-import'                              : { },
        '{{componentId}}-{{sectionId}}-import-add-method'                   : { },
        '{{componentId}}-{{sectionId}}-import-update-method'                : { },
        '{{componentId}}-{{sectionId}}-export'                              : { },
        '{{componentId}}-{{sectionId}}-dependencies-modules'                : {
            'placeholder'   : 'SELECT MODULE',
            'allowClear'    : true
        },
        '{{componentId}}-{{sectionId}}-dependencies-modulename'             : { },
        '{{componentId}}-{{sectionId}}-dependencies-moduleversion'          : { },
        '{{componentId}}-{{sectionId}}-dependencies-modulerepo'             : { },
        '{{componentId}}-{{sectionId}}-dependencies'                        : {
            'afterInit'     : function() {
                var id, label, moduleData;
                $('#{{componentId}}-{{sectionId}}-dependencies-external, ' +
                  '#{{componentId}}-{{sectionId}}-dependencies-external-version'
                ).on('keyup', function() {
                    if ($(this).val() !== '') {
                        label = 'external';
                        $('#{{componentId}}-{{sectionId}}-dependencies-modules').attr('disabled', true);
                        $('#{{componentId}}-{{sectionId}}-dependencies-external-add, ' +
                          '#{{componentId}}-{{sectionId}}-dependencies-external-remove').attr('disabled', false);
                    } else {
                        $('#{{componentId}}-{{sectionId}}-dependencies-modules').attr('disabled', false);
                        $('#{{componentId}}-{{sectionId}}-dependencies-external-add, ' +
                          '#{{componentId}}-{{sectionId}}-dependencies-external-remove').attr('disabled', true);
                    }
                });

                $('#{{componentId}}-{{sectionId}}-dependencies-modules').on('select2:clear', function(e) {
                    reset();
                });

                $('#{{componentId}}-{{sectionId}}-dependencies-modules').on('select2:select', function(e) {
                    id = e.params.data.id;
                    label = $(e.params.data.element).parents('optgroup').attr('label').toLowerCase();

                    moduleData = dataCollectionSectionForm['vars']['modules'][label][id];
                    $('#{{componentId}}-{{sectionId}}-dependencies-modulename').val(moduleData['name']);
                    $('#{{componentId}}-{{sectionId}}-dependencies-moduleversion').val(moduleData['version']);
                    $('#{{componentId}}-{{sectionId}}-dependencies-modulerepo').val(moduleData['repo']);

                    $('#{{componentId}}-{{sectionId}}-dependencies-add, ' +
                      '#{{componentId}}-{{sectionId}}-dependencies-remove').attr('disabled', false);

                    $('#{{componentId}}-{{sectionId}}-dependencies-external, ' +
                      '#{{componentId}}-{{sectionId}}-dependencies-external-version').attr('disabled', true);

                    $('#selected-module-information').attr('hidden', false);
                });

                function reset() {
                    $('#{{componentId}}-{{sectionId}}-dependencies-add, ' +
                      '#{{componentId}}-{{sectionId}}-dependencies-external-add, ' +
                      '#{{componentId}}-{{sectionId}}-dependencies-external-remove, ' +
                      '#{{componentId}}-{{sectionId}}-dependencies-remove').attr('disabled', true);
                    $('#{{componentId}}-{{sectionId}}-dependencies-external, ' +
                      '#{{componentId}}-{{sectionId}}-dependencies-external-version, ' +
                      '#{{componentId}}-{{sectionId}}-dependencies-modules').attr('disabled', false);

                    $('#{{componentId}}-{{sectionId}}-dependencies-modulename').val('');
                    $('#{{componentId}}-{{sectionId}}-dependencies-moduleversion').val('');
                    $('#{{componentId}}-{{sectionId}}-dependencies-modulerepo').val('');
                    $('#{{componentId}}-{{sectionId}}-dependencies-external').val('');
                    $('#{{componentId}}-{{sectionId}}-dependencies-external-version').val('');
                    $('#{{componentId}}-{{sectionId}}-dependencies-modules').val(0).trigger('change');

                    $('#selected-module-information').attr('hidden', true);
                }

                function prettyfyJson() {
                    $('#{{componentId}}-{{sectionId}}-dependencies')
                        .val(JSON.stringify(dataCollectionSectionForm['vars']['moduleDependencies'], null, 4));
                }

                $('#{{componentId}}-{{sectionId}}-dependencies-add, ' +
                  '#{{componentId}}-{{sectionId}}-dependencies-external-add').click(function(e) {
                    e.preventDefault();

                    var found = false;

                    if (label === 'core') {
                        dataCollectionSectionForm['vars']['moduleDependencies'][label] = { };
                        dataCollectionSectionForm['vars']['moduleDependencies'][label]['name'] = moduleData['name'];
                        dataCollectionSectionForm['vars']['moduleDependencies'][label]['version'] = moduleData['version'];
                        dataCollectionSectionForm['vars']['moduleDependencies'][label]['repo'] = moduleData['repo'];
                    } else if (label === 'external') {
                        if (dataCollectionSectionForm['vars']['moduleDependencies']['external'].length === 0) {
                            dataCollectionSectionForm['vars']['moduleDependencies']['external'] = { };
                        }

                        dataCollectionSectionForm['vars']['moduleDependencies'][label][$('#{{componentId}}-{{sectionId}}-dependencies-external').val()]
                            = $('#{{componentId}}-{{sectionId}}-dependencies-external-version').val();

                        reset();
                    } else {
                        for (var modules in dataCollectionSectionForm['vars']['moduleDependencies']) {
                            if (label === modules) {
                                $.each(dataCollectionSectionForm['vars']['moduleDependencies'][modules], function(index, mod) {
                                    if (mod['name'] === moduleData['name']) {
                                        found = true;
                                    }
                                });

                                if (!found) {
                                    dataCollectionSectionForm['vars']['moduleDependencies'][modules].push(moduleData);
                                }
                            }
                        }
                    }

                    reset();
                    prettyfyJson();
                });

                $('#{{componentId}}-{{sectionId}}-dependencies-remove, ' +
                  '#{{componentId}}-{{sectionId}}-dependencies-external-remove').click(function(e) {
                    e.preventDefault();

                    var found = false;
                    var foundIndex;

                    if (label === 'core') {
                        dataCollectionSectionForm['vars']['moduleDependencies'][label] = { };
                    } else if (label === 'external') {
                        delete dataCollectionSectionForm['vars']['moduleDependencies'][label][$('#{{componentId}}-{{sectionId}}-dependencies-external').val()];
                    } else {
                        for (var modules in dataCollectionSectionForm['vars']['moduleDependencies']) {
                            if (label === modules) {
                                $.each(dataCollectionSectionForm['vars']['moduleDependencies'][modules], function(index, mod) {
                                    if (mod['name'] === moduleData['name']) {
                                        found = true;
                                        foundIndex = index;
                                    }
                                });

                                if (found) {
                                    dataCollectionSectionForm['vars']['moduleDependencies'][modules].splice(foundIndex);
                                }
                            }
                        }
                    }

                    reset();
                    prettyfyJson();
                });

                prettyfyJson();
            }
        },
        '{{componentId}}-{{sectionId}}-dependencies-external'               : { },
        '{{componentId}}-{{sectionId}}-dependencies-external-version'       : { },
        '{{componentId}}-{{sectionId}}-form'                                : {
            rules: {
                '{{componentId}}-{{sectionId}}-name'                        : 'required',
                '{{componentId}}-{{sectionId}}-route'                       : 'required',
                '{{componentId}}-{{sectionId}}-app_type'                    : 'required',
                '{{componentId}}-{{sectionId}}-category'                    : 'required',
                '{{componentId}}-{{sectionId}}-version'                     : 'required',
                '{{componentId}}-{{sectionId}}-repo'                        : 'required',
                '{{componentId}}-{{sectionId}}-class'                       : 'required',
                '{{componentId}}-{{sectionId}}-settings'                    : 'required',
                '{{componentId}}-{{sectionId}}-menu_id'                     : 'required',
                '{{componentId}}-{{sectionId}}-menu'                        : 'required'
            },
            messages: {
                '{{componentId}}-{{sectionId}}-name'                        : 'Please enter name',
                '{{componentId}}-{{sectionId}}-route'                       : 'Please enter route',
                '{{componentId}}-{{sectionId}}-app_type'                    : 'Please enter app_type',
                '{{componentId}}-{{sectionId}}-category'                    : 'Please enter category',
                '{{componentId}}-{{sectionId}}-version'                     : 'Please enter version',
                '{{componentId}}-{{sectionId}}-repo'                        : 'Please enter repo',
                '{{componentId}}-{{sectionId}}-class'                       : 'Please enter class',
                '{{componentId}}-{{sectionId}}-settings'                    : 'Please enter settings',
                '{{componentId}}-{{sectionId}}-menu_id'                     : 'Please enter menu_id',
                '{{componentId}}-{{sectionId}}-menu'                        : 'Please enter menu'
            },
            onSubmitResponse: function(response) {
                //eslint-disable-next-line
                console.log(response);

                return false;
            }
        }
    });
</script>