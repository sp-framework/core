<form data-validateon="section" id="{{componentId}}-{{sectionId}}-form">
    <fieldset id="{{componentId}}-{{sectionId}}-fieldset">
        {% include '../common/ms/form.html' %}
        <div id="{{componentId}}-{{sectionId}}-components-form" hidden>
        </div>
        <div id="{{componentId}}-{{sectionId}}-packages-form" hidden>
            <div class="row">
                <div class="col">
                    {{adminltetags.useTag('fields',
                        [
                            'component'                      : component,
                            'componentName'                  : componentName,
                            'componentId'                    : componentId,
                            'sectionId'                      : sectionId,
                            'fieldId'                        : 'allowedFileMimeTypes',
                            'fieldLabel'                     : 'Allowed File Mime Types',
                            'fieldType'                      : 'json',
                            'fieldDataMaxLength'             : 4096,
                            'fieldHelp'                      : true,
                            'fieldHelpTooltipContent'        : 'Allowed File Mime Types. Format: JSON',
                            'fieldRequired'                  : true,
                            'fieldBazScan'                   : true,
                            'fieldBazJstreeSearch'           : true,
                            'fieldBazPostOnUpdate'           : true,
                            'fieldDataInputMaxLength'        : 4096,
                            'fieldTextareaRows'              : 4,
                            'fieldValue'                     : ''
                        ]
                    )}}
                </div>
            </div>
            <div class="row">
                <div class="col">
                    {{adminltetags.useTag('fields',
                        [
                            'component'                      : component,
                            'componentName'                  : componentName,
                            'componentId'                    : componentId,
                            'sectionId'                      : sectionId,
                            'fieldId'                        : 'allowedImageMimeTypes',
                            'fieldLabel'                     : 'Allowed Image Mime Types',
                            'fieldType'                      : 'json',
                            'fieldDataMaxLength'             : 4096,
                            'fieldHelp'                      : true,
                            'fieldHelpTooltipContent'        : 'Allowed Image Mime Types. Format: JSON',
                            'fieldRequired'                  : true,
                            'fieldBazScan'                   : true,
                            'fieldBazJstreeSearch'           : true,
                            'fieldBazPostOnUpdate'           : true,
                            'fieldDataInputMaxLength'        : 4096,
                            'fieldTextareaRows'              : 4,
                            'fieldValue'                     : ''
                        ]
                    )}}
                </div>
            </div>
            <div class="row">
                <div class="col">
                    {{adminltetags.useTag('fields',
                        [
                            'component'                      : component,
                            'componentName'                  : componentName,
                            'componentId'                    : componentId,
                            'sectionId'                      : sectionId,
                            'fieldId'                        : 'allowedImageSizes',
                            'fieldLabel'                     : 'Allowed Image Sizes',
                            'fieldType'                      : 'json',
                            'fieldDataMaxLength'             : 4096,
                            'fieldHelp'                      : true,
                            'fieldHelpTooltipContent'        : 'Allowed Image Sizes. Format: JSON',
                            'fieldRequired'                  : true,
                            'fieldBazScan'                   : true,
                            'fieldBazJstreeSearch'           : true,
                            'fieldBazPostOnUpdate'           : true,
                            'fieldDataInputMaxLength'        : 4096,
                            'fieldTextareaRows'              : 4,
                            'fieldValue'                     : ''
                        ]
                    )}}
                </div>
            </div>
        </div>
    </fieldset>
</form>
<script>
/* globals PNotify Swal dataCollection dataCollectionComponent dataCollectionSection dataCollectionSectionForm */

dataCollectionSection =
    $.extend(dataCollectionSection, {
        '{{componentId}}-{{sectionId}}-allowedFileMimeTypes'                        : {
            afterInit: function() {
                $('#{{componentId}}-{{sectionId}}-updateData').attr('disabled', true);

                $('#{{componentId}}-{{sectionId}}-usedModules').on('select2:select', function(e) {
                    $('#{{componentId}}-{{sectionId}}-updateData').attr('disabled', false);
                    $('#{{componentId}}-{{sectionId}}-updateData').attr('hidden', false);
                    var id = e.params.data.id;

                    var label = $(e.params.data.element).parents('optgroup').attr('label').toLowerCase();

                    if (dataCollectionSectionForm['vars']['usedModules'][label]['childs'][id]['settings']) {
                        $('#{{componentId}}-{{sectionId}}-allowedFileMimeTypes')
                            .val(JSON.stringify(dataCollectionSectionForm['vars']['usedModules'][label]['childs'][id]['settings']['allowedFileMimeTypes']));
                        $('#{{componentId}}-{{sectionId}}-allowedImageMimeTypes')
                            .val(JSON.stringify(dataCollectionSectionForm['vars']['usedModules'][label]['childs'][id]['settings']['allowedImageMimeTypes']));
                        $('#{{componentId}}-{{sectionId}}-allowedImageSizes')
                            .val(JSON.stringify(dataCollectionSectionForm['vars']['usedModules'][label]['childs'][id]['settings']['allowedImageSizes']));
                    }
                });
            }
        },
        '{{componentId}}-{{sectionId}}-allowedImageMimeTypes'                       : { },
        '{{componentId}}-{{sectionId}}-allowedImageSizes'                           : { },
        '{{componentId}}-{{sectionId}}-form'                                        : {
            ignore: ':submit, :reset, :image, :disabled, .ignore, .cr-slider',
            rules: {
                '{{componentId}}-{{sectionId}}-allowedFileMimeTypes'            : {'required' : true, 'json' : true},
                '{{componentId}}-{{sectionId}}-allowedImageMimeTypes'           : {'required' : true, 'json' : true},
                '{{componentId}}-{{sectionId}}-allowedImageSizes'               : {'required' : true, 'json' : true}
            },
            messages: {
            }
        }
    });
</script>