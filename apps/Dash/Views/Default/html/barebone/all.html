<div class="row">
    <div class="col">
        <h5>Install Barebone Modules</h5>
        <p>This will install 1 barebone module of each (apps, components, packages, views) that you can develop on your own.</p>
        <div class="form-group">
            <label for="all-barebone-name">App Name *</label>
            <div class="input-group">
                <input type="text" name="all-barebone-name" id="all-barebone-name" class="form-control" placeholder="Eg: Admin/Dashboard/Blog">
            </div>
        </div>
{#         <div class="form-group">
            <div class="checkbox icheck-info">
                <input type="checkbox" name="all-default" id="all-default">
                <label for="all-default">
                    Default app?
                </label>
            </div>
        </div> #}
        <button class="btn btn-primary float-right" type="button" id="all-install-barebone-button">Install</button>
    </div>
</div>
<div class="row text-center m-2" id="all-access-div" hidden>
    <div class="col">
        <a href="#" id="all-access" class="btn btn-success" disabled=""></a>
    </div>
</div>
<script>
/*global PNotify Swal */
$('#all-install-barebone-button').click(function() {
    $('#alert').attr('hidden', true);
    if ($('#all-barebone-name').val() === '') {
        $('#all-barebone-name').addClass('is-invalid');
        $('#all-barebone-name').focus(function() {
            $(this).removeClass('is-invalid');
        });
    } else {
        var postData =
            {
                'task'                      : 'all',
                'appName'           : $('#all-barebone-name').val().trim(),
                // "default"                   : $('#all-default')[0].checked,
                "force"                     : "0"
            };

        $('#all-install-barebone-button').attr('disabled', true);

        $.post('/{{route}}/barebone/install', postData, function(data) {
            if (data && data.responseCode === 0) {
                PNotify.success({
                  text          : data.responseMessage,
                  textTrusted   : true
                });

                $('#all-access-div').attr('hidden', false);
                $('#all-access').attr('disabled', false);
                $('#all-access').attr('href', '/' + data.bareboneModule.name.toLowerCase() + '/');
                $('#all-access').html('<i class="fa fa-check"></i> Access ' + $('#all-barebone-name').val() + ' app');


            } else if (data.responseCode === 1) {
                PNotify.error({
                  text          : data.responseMessage,
                  textTrusted   : true
                });

                $('#all-install-barebone-button').attr('disabled', false);
            // } else if (data.responseCode === 2) {
            //     Swal.fire({
            //         title               : data.responseMessage,
            //         icon                : 'info',
            //         showCancelButton    : true,
            //         showDenyButton      : true,
            //         confirmButtonText   : 'Install & Make Default',
            //         denyButtonText      : 'Install & Don\'t Make Default',
            //         width               : '50%'
            //     }).then((result) => {
            //         var postData;
            //         if (result.isConfirmed) {
            //             postData =
            //                 {
            //                     'task'                      : 'all',
            //                     'appName'           : $('#all-barebone-name').val().trim(),
            //                     "default"                   : $('#all-default')[0].checked,
            //                     "force"                     : "1"
            //                 };

            //             $.post('/{{route}}/barebone/install', postData, function(data) {
            //                 if (data && data.responseCode === 0) {
            //                     PNotify.success({
            //                         text            : data.responseMessage,
            //                         textTrusted     : true
            //                     });

            //                     $('#all-access-div').attr('hidden', false);
            //                     $('#all-access').attr('disabled', false);
            //                     $('#all-access').attr('href', '/' + data.bareboneModule.name.toLowerCase() + '/');
            //                     $('#all-access').html('<i class="fa fa-check"></i> Access ' + $('#all-barebone-name').val() + ' app');
            //                 } else if (data && data.responseCode === 1) {
            //                     PNotify.error({
            //                         text            : data.responseMessage,
            //                         textTrusted     : true
            //                     });
            //                 }
            //             }, 'json');
            //         } else if (result.isDenied) {
            //             $('#all-default')[0].checked = false;
            //             postData =
            //                 {
            //                     'task'                      : 'all',
            //                     'appName'           : $('#all-barebone-name').val().trim(),
            //                     "default"                   : 'false',
            //                     "force"                     : "0"
            //                 };

            //             $.post('/{{route}}/barebone/install', postData, function(data) {
            //                 if (data && data.responseCode === 0) {
            //                     PNotify.success({
            //                         text        : data.responseMessage,
            //                         textTrusted : true
            //                     });

            //                     $('#all-access-div').attr('hidden', false);
            //                     $('#all-access').attr('disabled', false);
            //                     $('#all-access').attr('href', '/' + data.bareboneModule.name.toLowerCase() + '/');
            //                     $('#all-access').html('<i class="fa fa-check"></i> Access ' + $('#all-barebone-name').val() + ' app');
            //                 } else if (data && data.responseCode === 1){
            //                     PNotify.error({
            //                         text        : data.responseMessage,
            //                         textTrusted : true
            //                     });
            //                 }
            //             }, 'json');
            //         } else {
            //             $('#all-install-barebone-button').attr('disabled', false);
            //         }
            //     });
            // }
            }
        }, 'json');
    }
});
</script>