{{adminltetags.useTag('content',
    [
        'component'             : table['component'],
        'componentName'         : componentName,
        'componentId'           : componentId,
        'parentComponentId'     : parent,
        'sectionId'             : 'listing',
        'contentType'           : 'sectionWithListing',
        'cardHeader'            : true,
        'cardType'              : 'primary',
        'cardIcon'              : 'receipt',
        'cardTitle'             : 'Purchase Orders',
        'cardAdditionalClass'   : 'rounded-0',
        'cardShowTools'         : ['maximize'],
        'dtFilter'              : true,
        'dtFilters'             : table['filters'],
        'dtFilterColumns'       : table['filterColumns'],
        'dtFixedHeader'         : true,
        'dtPrimaryButtons'      :
            {
                'componentId'           : componentId,
                'sectionId'             : 'listing',
                'buttonType'            : 'button',
                'buttons'               :
                    {
                        'add-purchase-order' : {
                            'title'                   : 'Add New Purchase Order',
                            'size'                    : 'sm',
                            'type'                    : 'primary',
                            'icon'                    : 'plus',
                            'buttonAdditionalClass'   : 'contentAjaxLink',
                            'position'                : 'right',
                            'url'                     : links.url('ims/stock/purchaseorders/q/id/0')
                        },
                        'sync-purchase-order' : {
                            'title'                   : 'Sync with xero',
                            'size'                    : 'sm',
                            'type'                    : 'primary',
                            'icon'                    : 'sync',
                            'position'                : 'right'
                        }
                    }
            },
        'dtTable'               : table,
        'dtColumns'             : table['columns'],
        'dtPostUrl'             : table['postUrl'],
        'dtPostUrlParams'       : table['postUrlParams'],
        'dtStriped'             : true,
        'dtStateSave'           : false,
        'dtBordered'            : false,
        'dtHideIdColumn'        : true,
        'dtNoOfColumnsToShow'   : 6,
        'dtTableCompact'        : true,
        'dtZeroRecords'         : 'No purchase orders data available. Add purchase order by clicking the Add new purchase order button.'
    ]
)}}
<script>
$('#{{componentId}}-listing-sync-purchase-order').click(function(e) {
    e.preventDefault();

    $(this).children('i').addClass('fa-spin');

    window.dataCollection['{{componentId}}']['{{componentId}}-listing']['datatable'].rows().clear().draw();
    $('.dataTables_empty').last().html('<i class="fas fa-cog fa-spin"></i> Loading...');

    var postData = { };
    postData[$('#security-token').attr('name')] = $('#security-token').val();

    $.post('{{links.url("ims/stock/purchaseorders/syncWithXero")}}', postData, function(response) {
        if (response.tokenKey && response.token) {
            $('#security-token').attr('name', response.tokenKey);
            $('#security-token').val(response.token);
        }
    }, 'json');
    // window.dataCollection['{{componentId}}']['{{componentId}}-listing']['BazContentSectionWithListing']._filterRunAjax();
});
</script>